<th:block th:replace="~{/layout/basic :: setContent(~{this :: content})}">
    <th:block th:fragment="content">

        <h2 class="border-bottom py-2" th:text="${article.title}"></h2>


        <h3 th:text="${article.users.nickname}">
        </h3>


        <div class="card my-3">
            <div class="card-body">
                <div class="card-text" style="white-space: pre-line;" th:text="${article.content}"></div>

                <div class="d-flex justify-content-end">
                    <div class="badge bg-light text-dark p-2 text-start">
                        <div th:text="${#temporals.format(article.create, 'yyyy-MM-dd HH:mm')}"></div>
                    </div>
                </div>
                <div>
                    <a th:href="@{|/article/modify/${article.id}|}" class="btn btn-primary" role="button"
                       sec:authorize="isAuthenticated()"
                       th:if="${article.users != null and #authentication.getPrincipal().getUsername() == article.users.username}"
                       th:text="수정"></a>
                    <a href="javascript:void(0);" th:data-uri="@{|/article/delete/${article.id}|}"
                       class="delete btn btn-primary" role="button"
                       sec:authorize="isAuthenticated()"
                       th:if="${article.users != null and #authentication.getPrincipal().getUsername() == article.users.username}"
                       th:text="삭제"></a>
                </div>
            </div>
        </div>
        <div th:each="articleImage : ${article.articleImgList}">
            <img id="imgId" th:src="@{${articleImage.imageUrl}} " alt="첨부이미지" th:if="articleImage != null"/>
        </div>

        <ul id="tag-list">
            <div th:each="tag :${article.articleHashtags}">
                <li class='tag-item' th:text="${tag.hashtagName}"><span idx='"+counter+"'></span></li>
            </div>

        </ul>

        <div id="resultDiv">
            <p th:if="${msg}!=null" th:text="${msg}"></p>
        </div>

        <!-- 답변의 갯수 표시 -->
        <h5 class="border-bottom my-3 py-2"
            th:text="|${#lists.size(article.articleCommentList)}개의 댓글이 있습니다.|"></h5>

        <div class="card my-3" th:each="articleComment : ${article.articleCommentList}">
            <div class="card-body">
                <div class="card-text" style="white-space: pre-line;" th:text="${articleComment.comment}"></div>
                <div class="d-flex justify-content-end">
                    <div class="badge bg-light text-dark p-2 text-start">
                        <div th:text="${#temporals.format(articleComment.create, 'yyyy-MM-dd HH:mm')}"></div>
                    </div>
                    <form th:action="@{|/articleComment/createReply/${articleComment.id}|}"
                          th:object="${articleCommentForm}" method="post" class="my-3">
                        <div th:replace="form_errors :: formErrorsFragment"></div>

                        <textarea  th:id="|commentReply${articleComment.id}|" name="content" rows="1" class="form-control"></textarea>

                        <input type="submit" name="commentReplySubmit_new"  th:id="|commentReplySubmit${articleComment.id}|" value="답글등록"
                               class="btn btn-primary my-2">
                        <div class="card my-3" th:each="articleCommentReply : ${articleComment.getChild()}">
                            <a th:href="@{|/articleComment/modify/${articleCommentReply.id}|}">수정</a>
                            <a th:href="@{|/articleComment/delete/${articleCommentReply.id}|}">삭제</a>
                            <div class="card-text" style="white-space: pre-line;"
                                 th:text="${articleCommentReply.comment}"></div>
                        </div>
                    </form>
                </div>
                <div class="my-3">

                    <a th:href="@{|/articleComment/modify/${articleComment.id}|}"
                       class="btn btn-sm btn-outline-secondary"
                       sec:authorize="isAuthenticated()"
                       th:if="${articleComment.users != null and #authentication.getPrincipal().getUsername() == articleComment.users.username}"
                       th:text="수정"></a>

                    <a href="javascript:void(0);" th:data-uri="@{|/articleComment/delete/${articleComment.id}|}"
                       class="delete btn btn-sm btn-outline-secondary" sec:authorize="isAuthenticated()"
                       th:if="${articleComment.users != null and #authentication.getPrincipal().getUsername() == articleComment.users.username}"
                       th:text="삭제"></a>
                </div>
            </div>
        </div>
        <!-- 답변 반복 끝  -->

        <!-- 답변 작성 -->
        <form th:action="@{|/articleComment/create/${article.id}|}" th:object="${articleCommentForm}" method="post"
              class="my-3">
            <div th:replace="form_errors :: formErrorsFragment"></div>

            <textarea id="commentReply_" name="content" rows="5" class="form-control"></textarea>
            <input id="commentReplySubmit_" type="submit" value="댓글등록" class="btn btn-primary my-2">
        </form>


        <script layout:fragment="script" type='text/javascript'>
            const delete_elements = document.getElementsByClassName("delete");
            Array.from(delete_elements).forEach(function (element) {
                element.addEventListener('click', function () {
                    if (confirm("정말로 삭제하시겠습니까?")) {
                        location.href = this.dataset.uri;
                    }
                    ;
                });
            });
            const recommend_elements = document.getElementsByClassName("recommend");
            Array.from(recommend_elements).forEach(function (element) {
                element.addEventListener('click', function () {
                    if (confirm("정말로 추천하시겠습니까??")) {
                        location.href = this.dataset.uri
                    }
                    ;
                });
            });


        </script>

        <!--<script layout:fragment="script" type='text/javascript'>-->
        <!--<script th:inline="javascript" type='text/javascript'>-->

        <!--    function dataSend() {-->
        <!--        var data = $("#input").val();-->
        <!--        var messageDTO = {-->
        <!--            result: data-->
        <!--        };-->
        <!--        $.ajax({-->
        <!--            type: "delete",-->
        <!--            url: url,-->
        <!--            dataType: 'text'-->
        <!--        }).done(function (result) {-->
        <!--            if (result == "ok") {-->
        <!--                alert("삭제에 성공하였습니다.");-->
        <!--                // location.href ~~~-->
        <!--            } else {-->
        <!--                alert("삭제에 실패하였습니다.");-->
        <!--            }-->
        <!--        }).fail(function (error) {-->
        <!--            alert("삭제에 실패하였습니다.");-->
        <!--        });-->
        <!--    }-->
        <!--</script>-->
    </th:block>
</th:block>
